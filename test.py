import numpy as np
import pytest

from sudoku import validate_board


@pytest.mark.parametrize(
    "board, expected",
    [
        (
            np.array(
                [
                    [1, 2, 6, 4, 8, 5, 9, 7, 3],
                    [4, 8, 5, 9, 3, 7, 1, 6, 2],
                    [9, 3, 7, 1, 2, 6, 4, 5, 8],
                    [8, 5, 9, 3, 7, 1, 2, 4, 6],
                    [2, 6, 4, 8, 5, 9, 3, 1, 7],
                    [3, 7, 1, 2, 6, 4, 8, 9, 5],
                    [5, 9, 3, 7, 1, 2, 6, 8, 4],
                    [6, 4, 8, 5, 9, 3, 7, 2, 1],
                    [7, 1, 2, 6, 4, 8, 5, 3, 9],
                ]
            ),
            True,
        ),
        (
            np.array(
                [
                    [1, 2, 3, 4, 5, 6, 7, 8, 9],
                    [2, 3, 4, 5, 6, 7, 8, 9, 1],
                    [3, 4, 5, 6, 7, 8, 9, 1, 2],
                    [4, 5, 6, 7, 8, 9, 1, 2, 3],
                    [5, 6, 7, 8, 9, 1, 2, 3, 4],
                    [6, 7, 8, 9, 1, 2, 3, 4, 5],
                    [7, 8, 9, 1, 2, 3, 4, 5, 6],
                    [8, 9, 1, 2, 3, 4, 5, 6, 7],
                    [9, 1, 2, 3, 4, 5, 6, 7, 8],
                ]
            ),
            False,
        ),
    ],
)
def test_validate_board(board, expected):
    assert validate_board(board) == expected


@pytest.mark.parametrize(
    "board, context",
    [
        (
            np.array(
                [
                    [1, 2, 3, 4, 5, 6, 7, 8, 9],
                    [2, 3, 4, 5, 6, 7, 8, 9, 1],
                    [3, 4, 5, 6, 7, 8, 9, 1, 2],
                    [4, 5, 6, 7, 8, 9, 1, 2, 3],
                    [5, 6, 7, 8, 9, 1, 2, 3, 4],
                    [6, 7, 8, 9, 1, 2, 3, 4, 5],
                    [7, 8, 9, 1, 2, 3, 4, 5, 6],
                    [8, 9, 1, 2, 3, 4, 5, 6, 7],
                    [9, 1, 2, 3, 4, 5, 6, 7, 0],
                ]
            ),
            pytest.raises(ValueError),
        ),
        (
            np.array(
                [
                    [1, 2, 3, 4, 5, 6, 7, 8],
                    [2, 3, 4, 5, 6, 7, 8, 1],
                    [3, 4, 5, 6, 7, 8, 1, 2],
                    [4, 5, 6, 7, 8, 1, 2, 3],
                    [5, 6, 7, 8, 1, 2, 3, 4],
                    [6, 7, 8, 1, 2, 3, 4, 5],
                    [7, 8, 1, 2, 3, 4, 5, 6],
                    [8, 1, 2, 3, 4, 5, 6, 7],
                    [1, 2, 3, 4, 5, 6, 7, 0],
                ]
            ),
            pytest.raises(ValueError),
        ),
    ],
)
def test_validate_board_raises(board, context):
    with context:
        validate_board(board)
